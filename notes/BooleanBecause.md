## BooleanBecause.c

### Source Code:

```c
#include <stdio.h>
#define uint64 unsigned long long

unsigned long long main() {
    unsigned int i = 0x50da;
    unsigned int j = 0xc0ffee;
    uint64 k = 0x7ea707a11ed;
    k ^= ~(i & j) | 0x7ab00;
    return l;
}
```

### Disassembly:

#### Frame 1: BooleanBecause.exe!func(...)
```assembly
sub rsp, 18h
mov dword ptr [rsp+4], 50DAh
mov dword ptr [rsp], 0C0FFEEh
mov rax, 7EA7077A11EDh
mov qword ptr [rsp+8], rax
mov eax, dword ptr [rsp]
mov ecx, dword ptr [rsp+4]
and ecx, eax
mov eax, ecx
not eax
or eax, 7AB00h
mov eax, eax
mov rcx, qword ptr [rsp+8]
xor rcx, rax
mov rax, rcx
mov qword ptr [rsp+8], rax
mov rax, word ptr [rsp+8]
add rsp, 18h
ret
```

## Analyzing the stack

### Return address to `BooleanBecause.exe!invoke_main(void)`

|Address|Value|
|-------------|-------------|
|0x000000000014FE0C|00000001|
|0x000000000014FE08|40001369|

### 16 byte alignment

|Address|Value|
|-------------|-------------|
|0x000000000014FE04|c2da2203|
|0x000000000014FE00|178bfbff|

### Initialized 0x7ea707a11ed value then calculates the value of k variable

|Address|Value|
|-------------|-------------|
|0x000000000014FDFC|000007ea|
|0x000000000014FDF8|8f85bed8|

### Initialized 0x50da value

|Address|Value|
|-------------|-------------|
|0x000000000014FDF4|000050da|

### Initialized 0xc0ffee value

|Address|Value|
|-------------|-------------|
|0x000000000014FDF0|00c0ffee|


## Breaking down each statements

### Frame 1: BooleanBecause.exe!main(...)

`sub rsp, 18h`
 - Subracts `rsp` by 18
 - 000000000014FE08 - 18
 - Address of `rsp`: 000000000014FDF0
 - Value of `rsp`: 0084250900000000

`mov dword ptr [rsp+4], 50DAh`
 - Moves the 50DA to `rsp` register with an offset of 4
 - Address of `rsp` (4 bytes): 000000000014FDF4
 - Value of `esp` (4 bytes): 000050DA

`mov dword ptr [rsp], 0C0FFEEh`
 - Moves C0FFEE to `rsp` register
 - Address of `rsp` (4 bytes): 000000000014FDF0
 - Value of `esp` (4 bytes): 00C0FFEE

`mov rax, 7EA707A11EDh`
 - Moves 7EA707A11ED into `rax` register

`mov qword ptr [rsp+8], rax`
 - Moves the value of `rax` into the stack with an offset of 8
 - Address of `rsp`: 000000000014FDF8
 - Value of `rax`: 000007EA707A11ED

`mov eax, dword ptr [rsp]`
 - Moves the `rsp` value into `rax` register
 - Address of `rsp`: 000000000014FDF0
 - Value of `rsp`: 00C0FFEE00000001
 - Value of `rax`: 0000000000C0FFEE
  
`mov ecx, dword ptr [rsp+4]`
 - Moves the `rsp` value with an offset of 4 into `rax` register
 - Address of `rsp`: 000000000014FDF4
 - Value of `rsp`: 707a11ed000050DA
 - Value of `rcx`: 00000000000050DA

`and ecx, eax`
 - Performs bitwise AND for `eax` and `ecx` register values then stores it into `rcx` register
 - 000050DA & 00C0FFEE = 000050CA
 - Value of `rcx`: 00000000000050CA

`mov eax, ecx`
 - Moves the `ecx` value into `rax` register
 - Value of `rax`: 0000000000C0FFEE
 - New Value of `rax`: 00000000000050CA

`not eax`
 - Performs NOT on `eax` register value
 - In other terms, this just flips the value on 2's complement
 - Value of `rax`: 00000000000050CA
 - New Value of `rax`: 00000000FFFFAF35

`or eax, 7AB00`
 - Performs Bitwise OR for `eax`
 - 0007AB00 | FFFFAF35 = 000050CA
 - Value of `rax`: 00000000FFFFAF35
 - New Value of `rax`: 00000000FFFFAF35

`mov eax, eax`
 - .

`mov rcx, qword ptr [rsp+8]`
 - Moves the `rsp` value with an offset of 8 into `rcx` register
 - Address of `rsp`: 000000000014FDF8
 - Value of `rsp`: 000007EA707A11ED
 - Value of `rcx`: 000007EA707A11ED

`xor rcx, rax`
 - Performs bitwise XOR for `rax` and `rcx` register values then stores it into `rcx` register
 - 00000000FFFFAF35 ^ 000007EA707A11ED = 7EA8F85BED8
 - Value of `rcx`: 000007EA8F85BED8

`mov rax, rcx`
 - Moves `rcx` value into `rax` register

`mov qword ptr [rsp+8], rax`
 - Moves `rax` value into `rsp` register with an offset of 8
 - Address of `rsp`: 000000000014FDF8

`mov rax, qword ptr [rsp+8]`
 - Moves `rsp` register value into `rax` register 

`add rsp, 18h`
 - `rsp`: 000000000014FDF0 + 18 = 000000000014FE08

 `ret`
  - Returns and continues the statement at `BooleanBecause.exe!invoke_main(void)`
  - `rsp`: 000000000014FE08 + 8 = 000000000014FE10
<hr>