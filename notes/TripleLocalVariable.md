## TripleLocalVariable.c

### Source Code:

```c
int func() {
    long long i = 0xf01dab1ef007ba11;
    long long j = 0x0b57ac1e5;
    long long k = 0x57abbadabad00;
    return i+j;
}

int main() {
	return func();
}
```

### Disassembly:
#### DoubleLocalVariable.exe!func(...)

```assembly
sub rsp, 28h
mov rax, 0F01DAB1EF007BA11h
mov qword ptr [rsp+8], rax
mov eax, 0B57AC1E5h
mov qword ptr [rsp], rax
mov rax,57ABBADABAD00h  
mov qword ptr [rsp+10h],rax  
mov rax, qword ptr [rsp]
mov rcx, qword ptr [rsp+8]
add rcx, rax
mov rax, rcx
add rsp 28h
ret
```

#### DoubleLocalVariable.exe!main(...)

```assembly
sub rsp, 28h
call func (0000000140001040)
add rsp 28h
ret
```

## Analyzing the stack

<i><b>Undef</b> just means that it's a padding/filler in the stack.</i>

|Address|Value|
|-------------|-------------|
|<mark>0x000000000014FE08</mark>|<span style="background-color: blue">0000000140001379</span> -> RETURN ADDRESS to `DoubleLocalVariable.exe!invoke_main(void)`|
|0x000000000014FE00|16-byte-stack-alignment-padding|
|0x000000000014FDF8|undef|
|0x000000000014FDF0|undef|
|0x000000000014FDE8|undef|
|0x000000000014FDE0|undef|
|<mark>0x000000000014FDD8</mark>|<span style="background-color: blue">0000000140001059</span> -> RETURN ADDRESS to `DoubleLocalVariable.exe!main(...)`|
|0x000000000014FDD0|16-byte-stack-alignment-padding|
|0x000000000014FDC8|16-byte-stack-alignment-padding|
|<mark>0x000000000014FDC0</mark>|<span style="background-color: green">0x57ABBADABAD00</span>|
|<mark>0x000000000014FDB8</mark>|<span style="background-color: green">0xF01DAB1EF007BA11</span>|
|<mark>0x000000000014FDB0</mark>|<span style="background-color: green">0xB57AC1E5h</span>|

## Breaking down each statements

<i>By setting the breakpoint at `main()`, the current RSP <mark>000000000014FE08</mark> contains a return address which goes back to `SingLocalVariable1.exe!invoke_main(void)`. Just to remind to make it less confusing.</i>

#### Frame 1: SingleLocalVariable.exe!main(...)

`sub rsp, 28h` - 000000000014FE08 - 28
 -  `rsp`: 000000000014FE08 - 28 = <mark>000000000014FDE0</mark>

`call func (0000000140001040)`
 - Proceeds to `SingleLocalVariable.exe2!func(...)`
 - `rsp`: 000000000014FDE0 - 8  = <mark>000000000014FDD8</mark>
 - Adds a return address on <mark>000000000014FDD8</mark>

`add rsp, 28h`
 - `rsp`: 000000000014FDE0 + 28 = <mark>000000000014FE08</mark>

 `ret`
  - Returns and continues the statement at `SingleLocalVariable.exe2!invoke_main(void)`
  - `rsp`: 000000000014FE08 + 8 = <mark>000000000014FE10</mark>
<hr>

#### Frame 2: SingleLocalVariable.exe!func(...)

`sub rsp 28h`
 - `rsp`: 000000000014FDD8 - 28 = <mark>000000000014FDB0</mark>

`mov rax, 0F01DAB1EF007BA11h`
 - Moves `0xF01DAB1EF007BA11` into `rax` register

`mov qword ptr [rsp+8], rax`
 - Moves `0xF01DAB1EF007BA11` into `0x000000000014FDB8`

`mov eax, 0B57AC1E5h`
 - Moves `0B57AC1E5h` into `rax` register

`mov qword ptr [rsp], rax`
 - Moves `0x0B57AC1E5h` into `rsp` register

`mov rax, 57ABBADABAD00h`
 - Moves `57ABBADABAD00h` into `rax` register

`mov qword ptr [rsp+10h], rax`
 - Moves `57ABBADABAD00h` into `0x000000000014FDC0`

`mov rax, qword ptr [rsp]`
 - Moves `0xF01DAB1EF007BA11` into `rax` register

`mov rcx, qword ptr [rsp+8]`
 - Moves `0xF01DAB1EF007BA11` into `rcx` register

`add rcx, rax`
 - `rcx`: 00000000B57AC1E5 + F01DAB1EF007BA11 = <mark>F01DAB1FA5827BF6</mark>

`mov rax, rcx`
 - Moves `0xF01DAB1EF007BA11` into `rax` register

`add rsp 28h`
 - `rsp`: 000000000014FDB0 + 28 = <mark>000000000014FDD8</mark>

`ret`
  - Returns and continues the statement at `DoubleLocalVariable.exe!main(void)`
  - `rsp`: 000000000014FDD8 + 8 = <mark>000000000014FDE0</mark>
<hr>
