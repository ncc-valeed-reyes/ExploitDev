## SingleLocalVarable1.c

### Source Code:

```c
int func() {
    int i = 0x5ca1ab1e;
    return i;
}

int main() {
	return func();
}
```

### Disassembly:

#### SingleLocalVariable.exe!func(...)
```assembly
sub rsp, 18h
mov dword ptr [rsp], 05ca1ab1eh
mov eax, dword ptr [rsp]
add rsp, 18h
ret
```

#### SingleLocalVariable.exe!main(...)
```assembly
sub rsp, 28h
call func (01400010000h)
add rsp, 28h
ret
```

## Analyzing the stack

<i><b>Undef</b> just means that it's a padding/filler in the stack.</i>

|Address|Value|
|-------------|-------------|
|<mark>0x000000000014FE08</mark>|<span style="background-color: blue">0000000140001349</span> -> RETURN ADDRESS to `SingleLocalVariable.exe!invoke_main(void)`|
|0x000000000014FE00|undef|
|0x000000000014FDF8|undef|
|0x000000000014FDF0|undef|
|0x000000000014FDE8|undef|
|0x000000000014FDE0|undef|
|<mark>0x000000000014FDD8</mark>|<span style="background-color: blue">0000000140001029</span> -> RETURN ADDRESS to `SingleLocalVariable.exe!main(...)`|
|0x000000000014FDD0|undef|
|0x000000000014FDC8|undef|
|0x000000000014FDC0|<span style="background-color: green">0x5ca1ab1e</span>|

## Breaking down each statements

<i>By setting the breakpoint at `main()`, the current RSP <mark>000000000014FE08</mark> contains a return address which goes back to `SingLocalVariable1.exe!invoke_main(void)`. Just to remind to make it less confusing.</i>

### Frame 1: SingleLocalVariable.exe!main(...)

`sub rsp, 28h`
 -  `rsp`: 000000000014FE08 - 28 = <mark>000000000014FDE0</mark>

`call func (01400010000h)`
 - Proceeds to `SingleLocalVariable.exe!func(...)`
 - Adds a return address on <mark>000000000014FDD8</mark>
 - 000000000014FDD8 - 8  = <mark>000000000014FDE0</mark>

`add rsp, 28h`
 - `rsp`: 000000000014FDE0 + 28 = <mark>000000000014FE08</mark>

 `ret`
  - Returns and continues the statement at `SingleLocalVariable.exe!invoke_main(void)`
  - `rsp`: 000000000014FE08 + 8 = <mark>000000000014FE10</mark>
<hr>

### Frame 2: SingleLocalVariable.exe!func(...)

`sub rsp, 18h`
 -  `rsp`: 000000000014FDE0 - 28 = <mark>000000000014FDC0</mark>
 
`mov dword ptr [rsp], 05ca1ab1eh`
 - Moves `0x5ca1ab1e` into `rsp` register

`mov eax, dword ptr [rsp]`
 - Moves the value of the rsp into `rax` register

`add rsp, 18h`
 -  `rsp`: 000000000014FDC0 + 18 = <mark>000000000014FDD8</mark>

 `ret`
  - Returns and continues the statement at `SingleLocalVariable.exe!main(...)`
  - `rsp`: 000000000014FDD8 + 8  = <mark>000000000014FDE0</mark>

## Notes to keep in mind

`mov eax, dword ptr [rsp]`
 - `eax` - it would just extend the 64 bit (RAX Register) with zeroes. E.g. ``00000000`5ca1ab1e``
 - `dword` - qword = 8 bytes, <mark>dword = 4 bytes</mark>, word = 2 bytes

<hr>