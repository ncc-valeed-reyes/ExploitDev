### Loading Binary File

```bash
user@ubuntu:~$ gdb --quiet ./fibber_bin 
Reading symbols from ./fibber_bin...
(No debugging symbols found in ./fibber_bin)
(gdb)
```

### Running Program that requires CLI args

```bash
user@ubuntu:~$ gdb ./echo_bin -q
Reading symbols from ./echo_bin...
(gdb) r
Starting program: /home/user/echo_bin 
You didn't enter an argv[1]
[Inferior 1 (process 60868) exited with code 034]
(gdb) r hi
Starting program: /home/user/echo_bin hi
You entered hi for argv[1]
[Inferior 1 (process 60872) exited with code 033]
(gdb) r yo
Starting program: /home/user/echo_bin yo
You entered yo for argv[1]
[Inferior 1 (process 60873) exited with code 033]
```

### Code Breakpoints: Setting, Listing, and Deleting

#### Setting Code Breakpoints

```bash
(gdb) break main
Breakpoint 1 at 0x11a9
(gdb) b fibbonacci
Breakpoint 2 at 0x1169
```

#### Listing Code Breakpoints

```bash
(gdb) info breakpoints
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00000000000011a9 <main>
2       breakpoint     keep y   0x0000000000001169 <fibbonacci>
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00000000000011a9 <main>
2       breakpoint     keep y   0x0000000000001169 <fibbonacci>
```

#### Deleting Breakpoints

```bash
(gdb) b main
Breakpoint 3 at 0x11a9
(gdb) info b
Num     Type           Disp Enb Address            What
3       breakpoint     keep y   0x00000000000011a9 <main>
(gdb) delete 3
(gdb) info b
No breakpoints or watchpoints.
```

### Code Breakpoints: Disabling and Enabling

#### Disabling Breakpoints

```bash
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00005555555551a9 <main>
    breakpoint already hit 1 time
(gdb) disable 1
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep n   0x00005555555551a9 <main>
    breakpoint already hit 1 time
```

#### Enabling Breakpoints

```bash
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep n   0x00005555555551a9 <main>
    breakpoint already hit 1 time
(gdb) enable 1
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00005555555551a9 <main>
    breakpoint already hit 1 time
```

### Examining and Modifying Registers and Memory:

#### Commands: x (examine), print, display

```bash
(gdb) info r rax rbx rsp
rax            0xface              64206
rbx            0x555555555220      93824992236064
rsp            0x7fffffffe038      0x7fffffffe038
```

Reference: <https://sourceware.org/gdb/onlinedocs/gdb/Registers.html>

```bash
(gdb) p/x $rax
$11 = 0xface
(gdb) p/u $rax
$12 = 64206
(gdb) p/d $rax
$13 = 64206
(gdb) p/d $ax
$14 = -1330
(gdb) p/gd $ax
Size letters are meaningless in "print" command.
(gdb) p/10d $ax
Item count other than 1 is meaningless in "print" command.
```

Reference: <https://www.sourceware.org/gdb/current/onlinedocs/gdb/Data.html#index-printing-data>

#### Viewing (Examining) Memory

```bash
(gdb) x/8xb $rsp
0x7fffffffe038: 0xb3    0xd0    0xde    0xf7    0xff    0x7f    0x00    0x00
(gdb) x/4xh $rsp
0x7fffffffe038: 0xd0b3  0xf7de  0x7fff  0x0000
(gdb) x/2xw $rsp
0x7fffffffe038: 0xf7ded0b3  0x00007fff
(gdb) x/1xg $rsp
0x7fffffffe038: 0x00007ffff7ded0b3
(gdb) x/s 0x555555556008
0x555555556008: "First %d elements of the Fibbonacci sequence: "
(gdb) x/3i $rip
=> 0x5555555551a9 <main>:   endbr64 
   0x5555555551ad <main+4>: push   %rbp
   0x5555555551ae <main+5>: mov    %rsp,%rbp
```

Reference: <https://sourceware.org/gdb/current/onlinedocs/gdb/Memory.html#index-examining-memory>

#### Modifying Registers

```bash
(gdb) set $rax = 0xdeadbeeff00dface
(gdb) p/x $rax
$15 = 0xdeadbeeff00dface
(gdb) set $ax = 0xcafef00d
(gdb) p/x $rax
$16 = 0xdeadbeeff00df00d
```

#### Modifying Memory

```bash
(gdb) x/1xg $rsp
0x7fffffffe038: 0x00007ffff7ded0b3
(gdb) set {char}$rsp = 0xFF
(gdb) x/1xg $rsp
0x7fffffffe038: 0x00007ffff7ded0ff
(gdb) set {short}$rsp = 0xFF
(gdb) x/1xg $rsp
0x7fffffffe038: 0x00007ffff7de00ff
(gdb) set {short}$rsp = 0xFFFF
(gdb) x/1xg $rsp
0x7fffffffe038: 0x00007ffff7deffff
(gdb) set {long long}$rsp = 0x1337bee7
(gdb) x/1xg $rsp
0x7fffffffe038: 0x000000001337bee7
```

#### Updating Stack View

`display/10xg $rsp` on x86 64-bit.

`display/10xw $esp` on x86 32-bit.

#### Stack Backtrace

```bash
(gdb) bt
#0  fibbonacci (n=3) at ./fibber.c:4
#1  0x00005555555556ea in fibbonacci (n=4) at ./fibber.c:8
#2  0x00005555555556ea in fibbonacci (n=5) at ./fibber.c:8
#3  0x0000555555555742 in main () at ./fibber.c:18
```

Reference: <https://sourceware.org/gdb/current/onlinedocs/gdb/Backtrace.html#Backtrace>

### Stepping through Assembly

#### Step Into vs. Step Over vs. Step Out

Step Into -> `si`

Step Over -> `ni`

Step Out -> `fin`

Reference: <https://sourceware.org/gdb/current/onlinedocs/gdb/Continuing-and-Stepping.html#Continuing-and-Stepping>

#### Run Until Address (aka temporary breakpoint)

`until <address>`

### Saving a persistent GDB Configuration


Add this list into ~/x.cfg

```
display/10i $rip
display/x $rbp
display/x $rsp
display/x $rax
display/x $rbx
display/x $rcx
display/x $rdx
display/x $rdi
display/x $rsi
display/x $r8
display/x $r9
display/x $r12
display/x $r13
display/x $r14
display/10gx $rsp
start
```

```bash
user@qemu-riscv:~$ gdb -q -x ./x.cfg fibber_bin                                 Reading symbols from fibber_bin...                                              Temporary breakpoint 1 at 0x71a: file fibber.c, line 14.                        [Thread debugging using libthread_db enabled]                                   Using host libthread_db library "/lib/riscv64-linux-gnu/libthread_db.so.1".
```

--------------------------

More cheatsheet references:

* <https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf>
* <https://users.ece.utexas.edu/~adnan/gdb-refcard.pdf>