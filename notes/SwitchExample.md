## SwitchExample.c

### Source Code:

```c
int main() {
    int a = atoi(argv[1]);
    switch (a) {
        case 0:
            return 1;
        case 1:
            return 2;
        default:
            return 3;
    }
    return 0xfee1fed;
}
```

### Disassembly:

#### Frame 1: SwitchExample.exe!func(...)
```assembly
mov qword ptr [rsp+10h], rdx
mov dword ptr [rsp+8], ecx
sub rsp, 38h
mov eax, 8
imul rax, rax, 1
mov rcx, qword ptr [rsp+48h]
mov rcx, qword ptr [rcx+rax]
call qword ptr [0000000140004178h]
mov dword ptr [rsp+24h], eax
mov eax, dword ptr [rsp+24h]
mov dword ptr [rsp+20h], eax
cmp dword ptr [rsp+20h], 0
je 0000000140001041
cmp dword ptr [rsp+20h], 1
je 0000000140001048
jmp 000000014000104F
mov eax, 1
jmp 000000014000105B
mov eax, 2
jmp 000000014000105B
mov eax, 3
jmp 000000014000105B
mov eax, 0FEE1FEDh
add rsp, 38h
ret
```

## Analyzing the stack

|Address|Value|
|-------------|-------------|
|0x0000000000595760|0000000000595778|
|0x0000000000595760|00000000005957d4|
|[...]|[...]|
|0x000000000014FE18|0000000000595760|
|0x000000000014FE10|0000245f00000002|
|0x000000000014FE08|0000000140001379 -> RETURN ADDRESS to `SwitchExample.exe!invoke_main(void)`|
|0x000000000014FE00|16-byte-stack-alignment-padding|
|0x000000000014FDF8|undef|
|0x000000000014FDF0|0000001000000010|
|0x000000000014FDE8|0000000140001145|
|0x000000000014FDE0|undef|
|0x000000000014FDD8|0000000140001129|
|0x000000000014FDD0|00000000005957d4|

## Breaking down each statements

### Frame 1: SwitchExample.exe!main(...)

`mov qword ptr [rsp+10h], rdx`
 - Moves `rdx` value into `rsp`
 - Address of `rsp`: 000000000014FE18
 - New value of `rsp`: 0000000000595760

`mov dword ptr [rsp+8], ecx`
 - Moves `ecx` value into `rsp`
 - Address of `rsp`: 000000000014FE10
 - New value of `rsp`: 0000245f00000002

`sub rsp, 38h`
 - Subracts `rsp` by 38
 - 000000000014FE08 - 38
 - Address of `rsp`: 000000000014FDD0

`mov eax, 8`
 - Moves 8 into `eax` register

`imul rax, rax, 1`
 - Multiplies `rax` value then stores it on the register itself
 - 8 * 1 = 8

`mov rcx, qword ptr [rsp+48h]`
 - Moves `rsp` value into `rcx` register
 - Address of `rsp`: 000000000014FE18
 - Value of `rsp`: 0000000000595760
 - New value of `rcx`: 0000000000595760

`mov rcx, qword ptr [rcx+rax]`
 - Moves `rcx` value into `rcx` register
 - 0000000000595760 + 0000000000000008
 - Value of `rsp`: 00000000005957d4
 - New value of `rcx`: 00000000005957d4

`call qword ptr [0000000140004178h]`
 - calls atoi func

`mov dword ptr [rsp+24h], eax`
 - Moves `rax` value into `rsp`
 - Address of `rsp` (4 bytes): 000000000014FDF4
 - Value of `rsp` (4 bytes): 00000010

`mov eax, dword ptr [rsp+24h]`
 - Moves `rsp` value into `rax`
 - Value of `rax` (4 bytes): 0000000000000010
 
`mov dword ptr [rsp+20h], eax`
 - Moves `rax` value into `rsp`
 - Address of `rsp` (4 bytes): 000000000014FDF0
 - Value of `rsp` (4 bytes): 00000010

`cmp dword ptr [rsp+20h], 0`
 - Compares 00000010 with 00000000

`je 0000000140001041`
  - Jumps to 0000000140001041, If Equal
  - If 00000010 == 00000000 = Jump is not taken (False)
  - `efl`: 00010202

`cmp dword ptr [rsp+20h], 1`
 - Compares 00000010 with 00000001

`je 0000000140001048`
  - Jumps to 0000000140001048, If Equal
  - If 00000010 == 00000001 = Jump is not taken (False)
  - `efl`: 00010216

`jmp 000000014000104F`
  - Jumps to 000000014000104F

<hr>

*skipped*

`mov eax, 1`
 - Moves 1 into `rax` register

`jmp 000000014000105B`
  - Jumps to 000000014000105B

`mov eax, 2`
 - Moves 2 into `rax` register

`jmp 000000014000105B`
  - Jumps to 000000014000105B

<hr>

`mov eax, 3`
 - Moves 3 into `rax` register

`jmp 000000014000105B`
  - Jumps to 000000014000105B

`mov eax, 0FEE1FEDh`
 - Moves FEE1FED into `rax` register

`add rsp, 38h`
 - `rsp`: 000000000014FDF0 + 18 = 000000000014FE08

 `ret`
  - Returns and continues the statement at `SwitchExample.exe!invoke_main(void)`
  - `rsp`: 000000000014FE08 + 8 = 000000000014FE10
<hr>